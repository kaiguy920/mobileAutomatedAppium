{"version":3,"file":"execute.js","names":["extensions","execute","script","args","match","log","info","replace","trim","executeMobile","_","isArray","isWebContext","errors","NotImplementedError","endpoint","chromedriver","jwproxy","downstreamProtocol","PROTOCOLS","MJSONWP","command","mobileCommand","opts","mobileCommandsMapping","shell","execEmuConsoleCommand","startLogsBroadcast","stopLogsBroadcast","changePermissions","getPermissions","performEditorAction","sensorSet","getDeviceTime","startScreenStreaming","stopScreenStreaming","getNotifications","listSms","pushFile","pullFile","pullFolder","deleteFile","isAppInstalled","queryAppState","activateApp","removeApp","terminateApp","installApp","clearApp","startService","stopService","startActivity","broadcast","getContexts","unlock","refreshGpsCache","startMediaProjectionRecording","isMediaProjectionRecordingRunning","stopMediaProjectionRecording","has","UnknownCommandError","keys"],"sources":["../../../lib/commands/execute.js"],"sourcesContent":["import _ from 'lodash';\nimport { errors, PROTOCOLS } from 'appium/driver';\n\nconst extensions = {};\n\nextensions.execute = async function execute (script, args) {\n  if (script.match(/^mobile:/)) {\n    this.log.info(`Executing native command '${script}'`);\n    script = script.replace(/^mobile:/, '').trim();\n    return await this.executeMobile(script, _.isArray(args) ? args[0] : args);\n  }\n  if (!this.isWebContext()) {\n    throw new errors.NotImplementedError();\n  }\n  const endpoint = this.chromedriver.jwproxy.downstreamProtocol === PROTOCOLS.MJSONWP\n    ? '/execute'\n    : '/execute/sync';\n  return await this.chromedriver.jwproxy.command(endpoint, 'POST', {\n    script,\n    args,\n  });\n};\n\nextensions.executeMobile = async function executeMobile (mobileCommand, opts = {}) {\n  const mobileCommandsMapping = {\n    shell: 'mobileShell',\n\n    execEmuConsoleCommand: 'mobileExecEmuConsoleCommand',\n\n    startLogsBroadcast: 'mobileStartLogsBroadcast',\n    stopLogsBroadcast: 'mobileStopLogsBroadcast',\n\n    changePermissions: 'mobileChangePermissions',\n    getPermissions: 'mobileGetPermissions',\n\n    performEditorAction: 'mobilePerformEditorAction',\n\n    sensorSet: 'sensorSet',\n\n    getDeviceTime: 'mobileGetDeviceTime',\n\n    startScreenStreaming: 'mobileStartScreenStreaming',\n    stopScreenStreaming: 'mobileStopScreenStreaming',\n\n    getNotifications: 'mobileGetNotifications',\n\n    listSms: 'mobileListSms',\n\n    pushFile: 'mobilePushFile',\n    pullFile: 'mobilePullFile',\n    pullFolder: 'mobilePullFolder',\n    deleteFile: 'mobileDeleteFile',\n\n    isAppInstalled: 'mobileIsAppInstalled',\n    queryAppState: 'mobileQueryAppState',\n    activateApp: 'mobileActivateApp',\n    removeApp: 'mobileRemoveApp',\n    terminateApp: 'mobileTerminateApp',\n    installApp: 'mobileInstallApp',\n    clearApp: 'mobileClearApp',\n\n    startService: 'mobileStartService',\n    stopService: 'mobileStopService',\n    startActivity: 'mobileStartActivity',\n    broadcast: 'mobileBroadcast',\n\n    getContexts: 'mobileGetContexts',\n\n    unlock: 'mobileUnlock',\n\n    refreshGpsCache: 'mobileRefreshGpsCache',\n\n    startMediaProjectionRecording: 'mobileStartMediaProjectionRecording',\n    isMediaProjectionRecordingRunning: 'mobileIsMediaProjectionRecordingRunning',\n    stopMediaProjectionRecording: 'mobileStopMediaProjectionRecording',\n  };\n\n  if (!_.has(mobileCommandsMapping, mobileCommand)) {\n    throw new errors.UnknownCommandError(`Unknown mobile command \"${mobileCommand}\". ` +\n      `Only ${_.keys(mobileCommandsMapping)} commands are supported.`);\n  }\n  return await this[mobileCommandsMapping[mobileCommand]](opts);\n};\n\nexport default extensions;\n"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AAEA,MAAMA,UAAU,GAAG,EAAnB;;AAEAA,UAAU,CAACC,OAAX,GAAqB,eAAeA,OAAf,CAAwBC,MAAxB,EAAgCC,IAAhC,EAAsC;EACzD,IAAID,MAAM,CAACE,KAAP,CAAa,UAAb,CAAJ,EAA8B;IAC5B,KAAKC,GAAL,CAASC,IAAT,CAAe,6BAA4BJ,MAAO,GAAlD;IACAA,MAAM,GAAGA,MAAM,CAACK,OAAP,CAAe,UAAf,EAA2B,EAA3B,EAA+BC,IAA/B,EAAT;IACA,OAAO,MAAM,KAAKC,aAAL,CAAmBP,MAAnB,EAA2BQ,eAAA,CAAEC,OAAF,CAAUR,IAAV,IAAkBA,IAAI,CAAC,CAAD,CAAtB,GAA4BA,IAAvD,CAAb;EACD;;EACD,IAAI,CAAC,KAAKS,YAAL,EAAL,EAA0B;IACxB,MAAM,IAAIC,cAAA,CAAOC,mBAAX,EAAN;EACD;;EACD,MAAMC,QAAQ,GAAG,KAAKC,YAAL,CAAkBC,OAAlB,CAA0BC,kBAA1B,KAAiDC,iBAAA,CAAUC,OAA3D,GACb,UADa,GAEb,eAFJ;EAGA,OAAO,MAAM,KAAKJ,YAAL,CAAkBC,OAAlB,CAA0BI,OAA1B,CAAkCN,QAAlC,EAA4C,MAA5C,EAAoD;IAC/Db,MAD+D;IAE/DC;EAF+D,CAApD,CAAb;AAID,CAhBD;;AAkBAH,UAAU,CAACS,aAAX,GAA2B,eAAeA,aAAf,CAA8Ba,aAA9B,EAA6CC,IAAI,GAAG,EAApD,EAAwD;EACjF,MAAMC,qBAAqB,GAAG;IAC5BC,KAAK,EAAE,aADqB;IAG5BC,qBAAqB,EAAE,6BAHK;IAK5BC,kBAAkB,EAAE,0BALQ;IAM5BC,iBAAiB,EAAE,yBANS;IAQ5BC,iBAAiB,EAAE,yBARS;IAS5BC,cAAc,EAAE,sBATY;IAW5BC,mBAAmB,EAAE,2BAXO;IAa5BC,SAAS,EAAE,WAbiB;IAe5BC,aAAa,EAAE,qBAfa;IAiB5BC,oBAAoB,EAAE,4BAjBM;IAkB5BC,mBAAmB,EAAE,2BAlBO;IAoB5BC,gBAAgB,EAAE,wBApBU;IAsB5BC,OAAO,EAAE,eAtBmB;IAwB5BC,QAAQ,EAAE,gBAxBkB;IAyB5BC,QAAQ,EAAE,gBAzBkB;IA0B5BC,UAAU,EAAE,kBA1BgB;IA2B5BC,UAAU,EAAE,kBA3BgB;IA6B5BC,cAAc,EAAE,sBA7BY;IA8B5BC,aAAa,EAAE,qBA9Ba;IA+B5BC,WAAW,EAAE,mBA/Be;IAgC5BC,SAAS,EAAE,iBAhCiB;IAiC5BC,YAAY,EAAE,oBAjCc;IAkC5BC,UAAU,EAAE,kBAlCgB;IAmC5BC,QAAQ,EAAE,gBAnCkB;IAqC5BC,YAAY,EAAE,oBArCc;IAsC5BC,WAAW,EAAE,mBAtCe;IAuC5BC,aAAa,EAAE,qBAvCa;IAwC5BC,SAAS,EAAE,iBAxCiB;IA0C5BC,WAAW,EAAE,mBA1Ce;IA4C5BC,MAAM,EAAE,cA5CoB;IA8C5BC,eAAe,EAAE,uBA9CW;IAgD5BC,6BAA6B,EAAE,qCAhDH;IAiD5BC,iCAAiC,EAAE,yCAjDP;IAkD5BC,4BAA4B,EAAE;EAlDF,CAA9B;;EAqDA,IAAI,CAAChD,eAAA,CAAEiD,GAAF,CAAMnC,qBAAN,EAA6BF,aAA7B,CAAL,EAAkD;IAChD,MAAM,IAAIT,cAAA,CAAO+C,mBAAX,CAAgC,2BAA0BtC,aAAc,KAAzC,GAClC,QAAOZ,eAAA,CAAEmD,IAAF,CAAOrC,qBAAP,CAA8B,0BADlC,CAAN;EAED;;EACD,OAAO,MAAM,KAAKA,qBAAqB,CAACF,aAAD,CAA1B,EAA2CC,IAA3C,CAAb;AACD,CA3DD;;eA6DevB,U"}